<!DOCTYPE html>
<html data-theme="light" lang="en">
<head>
    <base href="~/"/>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>@ViewData["Title"] - RazorHat_Todo_Template</title>

    <script src="https://unpkg.com/htmx.org@1.8.5"
            asp-fallback-src="~/lib/htmx.org/dist/htmx.min.js"
            asp-fallback-test="window.htmx"
            crossorigin="anonymous">
    </script>

    <script src="https://unpkg.com/htmx.org/dist/ext/include-vals.js"></script>

    <!-- Alpine Plugins -->
    <script defer src="https://cdn.jsdelivr.net/npm/@@alpinejs/persist@3.x.x/dist/cdn.min.js"></script>

    <!-- Alpine Core -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@@shoelace-style/shoelace@2.11.2/cdn/themes/light.css"/>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@@shoelace-style/shoelace@2.11.2/cdn/shoelace-autoloader.js"></script>


    <link href="https://cdn.jsdelivr.net/npm/daisyui@2.47.0/dist/full.css" rel="stylesheet" type="text/css"/>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2/dist/tailwind.min.css" rel="stylesheet" type="text/css"/>
    <script src="https://unpkg.com/xregexp/xregexp-all.js"></script>
    <script src="~/js/animations/hacky_text_animation.js"></script>

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true"/>
</head>
<body class='text-lg bg-base-500'>
<header>

    <!-- <div>

        @* <div class="drawer"> *@
        @*     <div class="drawer-side"> *@
        @*         <label for="my-drawer-3" class="drawer-overlay"></label> *@
        @*         <ul class="menu p-4 w-80 h-full bg-base-200"> *@
        @*      *@
        @*         <template x-for="route of routes"> *@
        @*             <div x-text="route.title"></div> *@
        @*             <div class="mb-3"> *@
        @*                 <label class="form-label" :for="title"></label> *@
        @*                 <a :href="path"></a> *@
        @*             </div> *@
        @*         </template> *@
        @*         </ul> *@
        @*      *@
        @*     </div> *@
        @* *@
        @* </div> *@

    </div> -->


</header>
<main role="main" class="pb-3">
    @RenderBody()
</main>

@await RenderSectionAsync("Scripts", required: false)

</body>

<script type='module'>

    const routes = await (async () => {
        let results = await import('./routes.json', {
            assert: {
                type: 'json'
            }
        })

        return results.default;
    })()

    localStorage.setItem('routes', JSON.stringify(routes));

</script>

<script>

    const included = ['Sandbox/Index'];
    const excluded = ['Error', 'Privacy'
    , 'Index'
    , 'Scrapes', 'FinishedScrapes'
    , 'FeatureRequest' 
    , 'Comments', 'Admin', 'ScrapeRequestForm'
    , 'Logs/Index'
    , 'Comments/Index'
    , 'Admin/Index'
    , 'Uploads/Index'
    , 'Markdown/Index'
    
    // , 'HxPostExample'
    ];

    const stored_routes = 
        JSON.parse(localStorage.getItem('routes'))
        // .filter(x => x.text.includes("Index")
        //  x.url.includes("Sandbox")
        // )
        // .filter(
        //     x => 
        //     !excluded.some(ex=> x.url.match(ex))
        //     // included.some(incl=>incl.match(x.url) )
        //     // ||
        //     // included.some(incl=>incl.match(x.text) )
        //     // ||          
        //     // !excluded.some(ex=> x.url.includes(ex))
        //    // ||
        //    // || 
        //    //  !excluded.some(ex=> x.text === 'Index')
        //     // ||
        //     // !excluded.some(ex=> ex.match(x.url))
        //     // x
        // // && included.includes(x.text)
        // )
        // .map(route=> {
        //     // console.log('route', route)
        //     // const parent_name = null //XRegExp.exec(route.url, `blah`).groups.
        //     // const pattern = XRegExp(`(?<parent>\w+)\/Index`);
        //     let text = route.url;
        //     // let pattern = /(?<parent>\w+)(\/Index)?/gi;
        //    
        //     let pattern = /((?<parent>\w+\/)+?(\/)?)*(?<name>\w+)/gi
        //    
        //     let groups = text.match(pattern);
        //     let parent_name =  groups?.length >= 1 ? groups[0] : null
        //     console.log('parent: ', parent_name);
        //     return {
        //        ... route,
        //        text: route.text.replace('Index', parent_name ?? '???')
        //        }
        //     }
        // )
        // .filter(x=> included.includes(x.text))
        || [] ;
    
    document.addEventListener('alpine:init', () => {
        console.log('initialized alpine') 
        console.log('stored routes :>> ', stored_routes);   
        Alpine.store('settings', {
            routes: stored_routes
            // routes: [{
            //     text: "hi"
            // }]
        })
    })
</script>

</html>


@* #region old_nav *@
@* *@
@* <script> *@
@*     document.addEventListener('alpine:init', () => { *@
@*          *@
@*          console.log('stores init...') *@
@*      Alpine.store('notifications', { *@
@*                  items: ['hot lava'], *@
@*                  notify(message) { *@
@*                      this.items.push(message) *@
@*                  } *@
@*              }) *@
@*         Alpine.store('darkMode', { *@
@*             on: false, *@
@*   *@
@*             toggle() { *@
@*                 this.on = ! this.on *@
@*             } *@
@*         }) *@
@*     }) *@
@* </script> *@
@* *@
@* <script> *@
@* *@
@* // .filter(r=> !r.includes('Index'))  // Exclude Indexes for now. *@
@* const stored_routes = JSON.parse(localStorage.getItem('routes')) || [] ; *@
@*     console.log('stored_routes :>> ', stored_routes); *@
@*      *@
@* Alpine.store('notifications', { *@
@*   items: ['blarg'], *@
@* *@
@*   notify(message) {  *@
@*     this.items.push(message) *@
@*   } *@
@* }) *@
@* *@
@* </script> *@
@* *@
@* <script> *@
@*     const stored_routes = JSON.parse(localStorage.getItem('routes')) || [] *@
@*             // .filter(r=> !r.includes('Index'))  // Exclude Indexes for now. *@
@*     ; *@
@*     console.log('stored_routes :>> ', stored_routes); *@
@* *@
@*     const non_index_routes = stored_routes?.filter(r=>!r.path.includes('Index')) *@
@* *@
@*     function setup_layout() { *@
@*         return { *@
@*             foo: 'bar', *@
@*             routes: non_index_routes || [] *@
@*         } *@
@*     } *@
@* </script> *@

@* 
<div
    x-show="false"
    class="navbar bg-base-100">
    <div class="navbar-start">
        <div class="dropdown">
            <label tabindex="0" class="btn btn-ghost lg:hidden">
                <svg xmlns="http://www.w3.org/2000/svg"
                     class="h-5 w-5" fill="none"
                     viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"/>
                </svg>
            </label>
            <ul tabindex="0" class="menu menu-compact dropdown-content mt-3 p-2 shadow bg-base-100 rounded-box w-52">
                <li tabindex="0">
                    <a class="justify-between">
                        Comments
                        <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                        </svg>
                    </a>
                    <ul class="p-2">
                        <li>
                            <a href="/Comments/Index">Home</a>
                        </li>
                        <li>
                            <a href="/Comments/ScriptureHighlighter">Scripture Highlighter</a>
                        </li>
                    </ul>
                </li>
                <li tabindex="1">
                    <a class="justify-between">
                        Sandbox
                        <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                        </svg>
                    </a>
                    <ul class="p-2">
                        <li>
                            <a href="/Sandbox/Index">Home</a>
                        </li>
                    </ul>
                </li>

                <li tabindex="2">
                    <a class="justify-between">
                        Tutorial
                        <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                        </svg>
                    </a>
                    <ul class="p-2">
                        <li>
                            <a href="/Tutorial/Index">Home</a>
                        </li>
                        <li>
                            <a href="/Tutorial/HxPostExample">Hx post</a>
                        </li>
                        <li>
                            <a href="/Tutorial/HxPatchExample">Hx Patch</a>
                        </li>
                    </ul>

                </li>

                <li tabindex="3">

                    <a class="justify-between">
                        Admin
                        <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                        </svg>
                    </a>
                    <ul class="p-2">
                        <li>
                            <a href="/Admin/Index">Admin</a>
                        </li>
                        <li>
                            <a href="/Admin/FeatureRequest">Requests</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <a class="btn btn-ghost normal-case text-xl">RazorHat_Todo_Template</a>
    </div>

    <div class="navbar-center hidden lg:flex">
        <ul class="menu menu-horizontal px-1">
            <li tabindex="0">
                <a class="justify-between">
                    Comments
                    <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                    </svg>
                </a>
                <ul class="p-2">
                    <li>
                        <a href="/Comments/Index">Home</a>
                    </li>
                    <li>
                        <a href="/Comments/Manual_Copies">Manual</a>
                    </li>
                    <li>
                        <a href="/Comments/Scrapes">Scrapes</a>
                    </li>
                    <li>
                        <a href="/Comments/ScrapeRequestForm">Request a Scrape</a>
                    </li>
                </ul>
            </li>

            <li tabindex="0">
                <a class="justify-between">
                    Admin
                    <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                    </svg>
                </a>
                <ul class="p-2">
                    <li>
                        <a href="/Admin/Index">Home</a>
                    </li>
                    <li>
                        <a href="/Admin/FeatureRequest">Requests</a>
                    </li>
                </ul>
            </li>

            <li>
                <a href='/Sandbox/Index'>Sandbox</a>
            </li>
            <li>
                <a href="/Comments/ScriptureHighlighter">Scripture Highlighter</a>
            </li>
            <li tabindex="2">
                <a class="justify-between">
                    Tutorial
                    <svg class="fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"/>
                    </svg>
                </a>
                <ul class="p-2">
                    <li>
                        <a href="/Tutorial/Index">Home</a>
                    </li>
                    <li>
                        <a href="/Tutorial/HxPostExample">Hx post</a>
                    </li>
                    <li>
                        <a href="/Tutorial/HxPatchExample">Hx Patch</a>
                    </li>
                </ul>
            </li>

        </ul>
    </div>
    <!-- <div class="navbar-end">
        ...
    </div> -->
</div>
 *@
@* #endregion *@


@* OLD SIDEBAR *@


@* <div *@
@*     class="btm-nav"> *@
@*     <button> *@
@*         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> *@
@*             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/> *@
@*         </svg> *@
@*     </button> *@
@*     <button class="active"> *@
@*         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> *@
@*             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/> *@
@*         </svg> *@
@*     </button> *@
@*     <button> *@
@*         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"> *@
@*             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/> *@
@*         </svg> *@
@*     </button> *@
@* </div> *@